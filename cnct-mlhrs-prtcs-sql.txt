Conceitos e melhores práticas com banco de dados PostgreSQL

a) Fundamentos de Banco de Dados

O que são dados?
Valores brutos, fatos brutos, observações documentadas, registros
soltos, que são recolhidos e armazenados sem sofrer qualquer
tratamento.

O que são informações?
Estruturação de dados,organização de dados.Conjunto de dados
relacionados entre si que geram valor, que criam sentidos aos
dados.Material do conhecimento.

2002 - dado - sem valor, significado.
2002 é o ano em que... - informações 

Modelos relacionais

modelar - criar modelo que explique as características de funcionamento/o
comportamento do software.No nosso caso,modelo de dados.

Definição
Mdelo mais comum, q8ue classifica e organiza as informações em tabelas com
linhas e colunas.As linhas, ou tuplas, são os dados organizados, são os
valores das tabelas, e as colunas são os atributos destes dados.

Nós entendemos tabelas,mas para um computador a interpretação é diferente,
de forma que só assim:

telefone.1=proprietarios.1 ele entende

Tabelas
Conjuntos de dados dispostos em colunas e linhas referentes a um
objeto comum.As colunas são consideradas como "campos" da tabela,
como atributos da tabela.As linhyas são chamadas também de tuplas,
e é onde estão contidos os valores,os dados.  
 

O que pode ser definido como tabela?
-Coisas tangíveis
  - Elementos físicos(carro,veículo,produto,animal)
-Funções
  - Perfis de usuário,status de compra.
-Eventos ou ocorrencias
  -Produtos de um pedido, histórico de dados.

Colunas Importantes
-Chave Primária / Primary Key / PK
  - Conjunto de um ou mais campos que nunca se repetem.Identidade
    da tabela.São utilizados como índice de referencia na criação de
    relacionamentos entre tabelas.
-Chave Estrangeira / Foreign Key / FK
  - Valor de referencia a uma PK de outra tabela ou da mesma tabela 
    para criar um relacionamento entre tabelas.


Sistema de gereciamento d banco de dados
Ou Sistemas de gestão de base de dados.Chamamos pela sigla SGBD.
Conjunto de programas ou softwares responsáveis pelo gerenciamento
de um banco de dados.
Programas que facilitam a administração de um bd. 
Exemplo de programas:
MongoDB, MySQL, PostgreSQL, IBM DB2 e etc.
Introdução ao PostgreSQL
O que é o PostgreSQL?
Sistema de gerenciamento de banco de dados objeto relacional.

Teve início no Departamento de Ciencia da Computação na 
Universidade da Califórnia em Berkeley em 1986.

SGBD Opensource

Opensource/código aberto
pode ser utilizado, modificado e distribuído pra qualquer
pessoa com qualquer finalidade.
 

Arquitetura multiprocessos
(acontece muuuiiita coisa por trás)

Modelo cliente/servidor (do Postgre)
Tenho processos que acontecem só na máquina cliente ou só no servidor.
Os do servidor são os exibidos anteriormente, e os do cliente são
a interface gráfica pra fazer a conexão com o bd,terminal,unix,
aplicação web ou mobile enviando comandos pro bd e etc.


Pinrcipais características
-Opensource
-Point in time recovery
-Linguagem procedural(SQL) com suporte a várias linguagens de progrmç
(perl, python, etc)
-Views, functions, procedures, triggers
-Consultas complexas e Common table expressions (CTE)
-Suporte a dados geográficos(PosyGIS)
-Controle de concorrencia multi-versão

Instalação e documentação do PostgreSQL

Site oficial:
https://www.postgresql.org/
Download com instruções passo a passo:
https://www.postgresql.org/download/
Documentação completa:
https://www.postgresql.org/docs/manuals/

e d) feito

-----------------------------------------------------------------
//dia 05/07

Objetos e tipos de dados do PostgreSQL

a) O que é o arquivo postgresql.conf

arquivo postgresql.conf

Definição 
Arquivo onde estão definidas e armazenadas todas as 
configurações do servidor PostgreSQL.
Akguns parametros só podem ser alterados com a reinicializa-
_ção do banco de dados.
A view pg-settings, acessada por dentro do banco de dados,
guarda todas as configurações atuais.

SELECT name, setting
FROM pg_settings;

Ou é possível utilizar o comando

SHOW[parametro];

Localização do arquivo postgresql.conf
Por padrão, encontra-se dentro do diretório PGDATA definido
no momento da inicialização do cluster de banco de dados.

No sistema operacional Ubuntu, se o PostgreSQL foi instalado
a partir do repositório oficial, o local do arquivo 
postgresql.conf será diferente do diretório de dados.

/etc/postgresql/[versão]/[nome do cluster]/postgresql.conf 

Configurações de conexão

- LISTEN_ADRESSES
  Endereço(s) TCP/IP das interfaces que o servidor PostgreSQL
vai escutar/liberar conexões.
- PORT
  A porta TCP que o servidor PostgreSQL vai ouvir.O padrão é
5432.
- MAX_CONNECTIONS
  Número máximo de conexões simultaneas no servidor PostgreSQL.
- SUPERUSER_RESERVED_CONNECTIONS
  Número de conexões (slots) reservadas para conexões ao banco
de dados de super usuários
- AUTHENTICATION_TIMEOUT
   Tempo máximo em segundos para o cliente conseguir uma conexão
com o servidor.
- PASSWORD_ENCRYPTION
   Algoritmo de criptografia para senhas dos novos usuários 
criados no banco de dados.
- SSL
  Habilita a conexão criptografada por SSL
  (Somente se o  PostgreSQL foi compilado com suporte SSL) 

Configurações de memória

- SHARED_BUFFERS
  Tamanho da memória compartilhada do servidor PostgreSQL para
cache/buffer de tabelas, índices e demais relações.
- WORK_MEM (memória separadinha)
  Tamanho da memória para operações de agrupamento e ordenação
(ORDER BY, DISTINCT, MERGE JOINS).
- MAINTENANCE_WORK_EM (operações administrativas)
  Tamanho da memória para operações como VACUUM,INDEX,ALTER,
TABLE.

Obs: não coloque * em um servidor em produção,pois isso permite
que qualquer um acesse e prejudica a segurança.No caso de 
estar em testes eu posso 
colocar o *.

listen_adresses = 'local host' (padrão)
listen_adresses = '*' (não pode)

O arquivo pg_hba.conf

Definição
Arquivo responsável pelo controle de autentificação dos
usuários no servidor PostgreSQL.
O formato do arquivo pode ser:

local     database user auth-method   [auth-options]
host      database user adress      auth-method  [auth-options]
hostssl   database user adress      auth-method  [auth-options]
hostnossl database user adress      auth-method  [auth-options]
host      database user IP-adress   IP-mask       auth-method    [auth-options]
hostssl   database user IP-adress   IP-mask       auth-method    [auth-options]
hostnossl database user IP-adress   IP-mask       auth-method    [auth-options] 

(tem mais ao lado ->)

auth-method(forma de autenticação)
auth-options(opções de autenticação)

host - endereço de onde vem a conexão
hostssl - desde que aquele endereço esteja usando o ssl
hostnossl - não requisita cnexão criptografada.

Métodos de autenticação
- TRUST (conexão por requisição de senha)
- REJECT (rejeitar conexões)
- MD5 (criptografar md5)
- PASSWORD (senha sem criptografia)
- GSS (generic security service application program interface)
- SSPI (security support provider interface - somente para 
Windows)
- KRB5(kerberos V5)
- IDENT(utiliza o usuário do sistema operacional do cliente via
ident server)
- PEER(utiliza o usuário do sistema operacional do cliente)
- LDAP(Idao server)
- RADIUS(radius server)
- CERT(autenticação via certificado ssl do cliente)
- PAM(pluggable authentication modules.O usuário precisa estar
no )

//dia 07/07

O arquivo pg_ident.conf

Definição
Arquivo responsável por mapear os usuários do sistema operacional
com os usuários do banco de dados.
Localizado no diretório de dados PGDATA da sua instalação.
A opção ident deve ser utilizada no arquivo pg_hba.conf.

Ident cria mapeamentos, funciona como:

# MAPNAME SYSTEM-USERNAME PG-USERNAME
diretoria daniel          pg_diretoria
comercial tiburcio        pg_comercial
comercial valdeci         pg_comercial

Comandos administrativos do PostgreSQL

No services do Windows eu posso acessar os comandos facilmente
pois ele tem interface gráfica com o start, stop e etc.


se o Postgre foi instalado compilado, então tenho:

Binários do PostgreSQL
- createdb (cria banco de dados por fora do cluster)
- createuser (cria user)
- dropdb     (apaga o bd)
- dropuser   (apaga o user)
- initdb      (inicia o cluster, cria coisas pra mim)
- pg_ctl      (pra controlar o banco de dados start stop)
- pg_basebackup (copia um backup de toda a estrutura)
- pg_dump / pg_dumpall (pseudobackup, pois vais extrair um 
formato de texto ou outro as infos daquele momento do banco de
dados.PG_DUMP NÃO É BACKUP)
- pg_restore(restaura os arquivos que gerei com o dump)
- psql (arquivo binário pra entrar no banco de dados via SO)
- reindexdb(fazer reindex)
- vacuumdb (reorganizar todas as tabelas)

(algum dos mais importantes)

Arquitetura/Hierarquia

Cluster
Coleção de banco de dados que compartilham as mesmas 
configurações (arquivos de configuração PostgreSQL e do SO
(porta, listen_adresses, etc)).

Banco de dados(database)
Conjunto de schemas com seus objetos/relações (tabelas,
funçõe,views, etc).

Schema
Conjunto de objetos/relações (tabelas,funçõe,views, etc).

b)Conheça a ferramenta PGAdmin


PGAdmin

Sempre que tiver problema para conectar,confira:

Importante para conexão

1. Liberar acesso ao cluster em postgresql.conf

// dia 12/07

2. Liberar acesso ao cluster para o usuário do banco de
dadis em pg_hba.cong

3. Criar/editar usuários.


local all postgres md5 (md5 em tudo)


reload - recarrega

é uma boa prática colocar comentários no bd


tuples in - inserts, deletes, updates
tuples out - o que é retornado dos comandos sql













































































































